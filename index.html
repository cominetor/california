
<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Clienti Mascus Bauma</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background: #f5f5f5;
    }
    header {
      background: #2c3e50;
      color: white;
      padding: 15px;
      text-align: center;
      font-size: 20px;
    }
    input[type="text"] {
      width: 90%;
      padding: 10px;
      margin: 10px auto;
      display: block;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 16px;
    }
    .cliente {
      background: white;
      margin: 10px;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      cursor: pointer;
      position: relative;
    }
    .cliente h3 {
      margin: 0 0 5px 0;
    }
    .cliente small {
      color: #888;
    }
    .visitato-icon {
      position: absolute;
      top: 10px;
      right: 15px;
      font-size: 18px;
      color: green;
    }
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.6);
      justify-content: center;
      align-items: center;
    }
    .modal-content {
      background: white;
      padding: 20px;
      border-radius: 10px;
      width: 90%;
      max-height: 90%;
      overflow-y: auto;
    }
    textarea {
      width: 100%;
      height: 100px;
      margin-top: 10px;
      font-size: 16px;
    }
    button {
      margin-top: 10px;
      padding: 10px;
      font-size: 16px;
      border: none;
      border-radius: 5px;
      background: #2c3e50;
      color: white;
      cursor: pointer;
      width: 100%;
    }
    .close-btn {
      background: #bdc3c7;
    }
    label {
      display: block;
      margin-top: 15px;
    }
  </style>
</head>
<body>

<header>Clienti Mascus Bauma</header>
<input type="text" id="searchInput" placeholder="Cerca cliente..." oninput="filterClienti()">

<div id="listaClienti"></div>

<div class="modal" id="schedaCliente">
  <div class="modal-content">
    <h2 id="clienteNome"></h2>
    <p><strong>Tipo:</strong> <span id="clienteTipo"></span></p>
    <p><strong>Hall:</strong> <span id="clienteHall"></span></p>
    <p><strong>CAP:</strong> <span id="clienteCAP"></span></p>
    <p><strong>Città:</strong> <span id="clienteCitta"></span></p>
    <p><strong>Paese:</strong> <span id="clientePaese"></span></p>
    <label for="fotoCliente">Foto biglietto da visita:</label>
    <input type="file" accept="image/*" id="fotoCliente" onchange="salvaImmagine()" style="margin-top:5px;">
    <button onclick="rimuoviImmagine()" type="button" style="margin-top:10px; background:#e74c3c;">Rimuovi foto</button>
    <div id="previewFoto" style="margin-top:10px;"></div>
    <label><input type="checkbox" id="visitatoCheck"> Cliente visitato</label>
    <label for="note">Note personali:</label>
    <textarea id="note"></textarea>
    <button onclick="salvaNote()">Salva</button>
    <button class="close-btn" onclick="chiudiScheda()">Chiudi</button>
  </div>
</div>


<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
<script>
  const supabaseUrl = "https://ypywsydqczhipblukehm.supabase.co";
  const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlweXdzeWRxY3poaXBibHVrZWhtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDMwMTMzNTQsImV4cCI6MjA1ODU4OTM1NH0.7OFLPUuzQ1udqGpZ716n_b7cs3BZ-sOohX3igzpprEA";
  const supabase = supabase.createClient(supabaseUrl, supabaseKey);
const clienti = [{"nome": "Agri World srl", "tipo": "Prospect", "hall": "B2.332", "cap": "70022", "città": "Altamura", "paese": "Italy"}, {"nome": "BERTI MACCHINE AGRICOLE S.p.A", "tipo": "Ex-customer", "hall": "B5.538", "cap": "37042", "città": "Caldiero(VR)", "paese": "Italy"}, {"nome": "Batmatic Srl", "tipo": "Prospect", "hall": "A1.105", "cap": "43010", "città": "Fontevivo", "paese": "Italy"}, {"nome": "Beretta Alfredo s.r.l.", "tipo": "Prospect", "hall": "FN.618/1", "cap": "20842", "città": "Besana Brianza (MI)", "paese": "Italy"}, {"nome": "Betonmec srl", "tipo": "Prospect", "hall": "B1.148", "cap": "6055", "città": "MARCSIANO (PG)", "paese": "Italy"}, {"nome": "Boscaro srl", "tipo": "Prospect", "hall": "FM.708/7", "cap": "36020", "città": "Campiglia dei Berici", "paese": "Italy"}, {"nome": "C&amp;F srl", "tipo": "Prospect", "hall": "C5.500", "cap": "73100", "città": "Lecce", "paese": "Italy"}, {"nome": "C.A.M.E. srl", "tipo": "Prospect", "hall": "C5.427", "cap": "36025", "città": "Noventa Vicentina", "paese": "Italy"}, {"nome": "C4 Meccanica srl", "tipo": "Prospect", "hall": "C4.709", "cap": "6019", "città": "Umbertide", "paese": "Italy"}, {"nome": "CAME s.r.l.", "tipo": "Prospect", "hall": "C5.427", "cap": "36025", "città": "Noventa Vicentina", "paese": "Italy"}, {"nome": "CAMS srl", "tipo": "Prospect", "hall": "FS.1213/1", "cap": "40024", "città": "Castel S. Pietro Terme", "paese": "Italy"}, {"nome": "CARON A&amp;D SRL", "tipo": "Prospect", "hall": "A3.500", "cap": "36060", "città": "PIANEZZE", "paese": "Italy"}, {"nome": "CEP Europe S.r.l.", "tipo": "Prospect", "hall": "A5.235", "cap": "41021", "città": "Fanano", "paese": "Italy"}, {"nome": "CIFA S.p.A.", "tipo": "Prospect", "hall": "FS.1105/4", "cap": "20030", "città": "SENAGO", "paese": "Italy"}, {"nome": "CM Srl", "tipo": "Customer", "hall": "FS.1213/4", "cap": "48017", "città": "Conselice", "paese": "Italy"}, {"nome": "CMB s.r.l", "tipo": "Prospect", "hall": "B5.328", "cap": "36020", "città": "ASIGLIANO VENETO", "paese": "Italy"}, {"nome": "CMC srl", "tipo": "Prospect", "hall": "FS.1203/5", "cap": "70124", "città": "Bari", "paese": "Italy"}, {"nome": "CNH Industrial", "tipo": "Customer", "hall": "FM.714/9", "cap": "10156", "città": "Torino", "paese": "Italy"}, {"nome": "CORIMAG srl", "tipo": "Prospect", "hall": "B5.324", "cap": "10080", "città": "Bosconero (TO)", "paese": "Italy"}, {"nome": "CTE spa", "tipo": "Prospect", "hall": "FS.1103/10", "cap": "38068", "città": "Rovereto (TN)", "paese": "Italy"}, {"nome": "Cappellotto Spa", "tipo": "Prospect", "hall": "B4.403", "cap": "33074", "città": "Fontanafredda (PN)", "paese": "Italy"}, {"nome": "Casagrande Spa", "tipo": "Prospect", "hall": "FN.520/9", "cap": "33074", "città": "Fontanafredda", "paese": "Italy"}, {"nome": "Cattini Oleopneumatica Srl", "tipo": "Prospect", "hall": "C4.419", "cap": "42043", "città": "Gattatico", "paese": "Italy"}, {"nome": "Ciancaleoni s.r.l.", "tipo": "Customer", "hall": "FN.620/5", "cap": "6038", "città": "Spello", "paese": "Italy"}, {"nome": "Cormach Srl", "tipo": "Prospect", "hall": "FN.722/9", "cap": "25018", "città": "Montichiari (BS)", "paese": "Italy"}, {"nome": "Cosben srl", "tipo": "Prospect", "hall": "B5.140", "cap": "41030", "città": "Solara", "paese": "Italy"}, {"nome": "DIECI S.r.l.", "tipo": "Prospect", "hall": "FS.1108/1", "cap": "42027", "città": "Montecchio Emilia (RE)", "paese": "Italy"}, {"nome": "DULEVO International Spa", "tipo": "Prospect", "hall": "FS.1009", "cap": "43012", "città": "Fontanellato (PR)", "paese": "Italy"}, {"nome": "Definitive CLM s.r.l.", "tipo": "Prospect", "hall": "C5.236", "cap": "41030", "città": "San Prospero sulla Secchia", "paese": "Italy"}, {"nome": "Dondi S.p.A.", "tipo": "Prospect", "hall": "B5.430", "cap": "6083", "città": "Bastia Umbra", "paese": "Italy"}, {"nome": "Elsa srl", "tipo": "Customer", "hall": "B5.415", "cap": "88050", "città": "Sellia Marina (CZ)", "paese": "Italy"}, {"nome": "Emiliana Serbatoi srl", "tipo": "Ex-customer", "hall": "B5.548", "cap": "41011", "città": "Campogalliano (MO)", "paese": "Italy"}, {"nome": "Euromach Srl", "tipo": "Prospect", "hall": "FN.722/9", "cap": "25018", "città": "MONTICHIARI", "paese": "Italy"}, {"nome": "Euromecc srl", "tipo": "Prospect", "hall": "C1.328", "cap": "95045", "città": "Misterbianco", "paese": "Italy"}, {"nome": "Europarts srl", "tipo": "Prospect", "hall": "A6.450", "cap": "35010", "città": "VIGONZA", "paese": "Italy"}, {"nome": "FERRARI INTERNATIONAL S.P.A.", "tipo": "Prospect", "hall": "FN.920/10", "cap": "42122", "città": "Reggio Emilia", "paese": "Italy"}, {"nome": "FIORI GROUP S.p.A.", "tipo": "Prospect", "hall": "C6.113", "cap": "41034", "città": "Finale Emilia (MO)", "paese": "Italy"}, {"nome": "Femac srl", "tipo": "Prospect", "hall": "B5.203", "cap": "6018", "città": "CITTA&#x27; DI CASTELLO", "paese": "Italy"}, {"nome": "G.A. Ricambi S.p.A.", "tipo": "Prospect", "hall": "A5.336", "cap": "41018", "città": "San Cesario Sul Panaro (Mo)", "paese": "Italy"}, {"nome": "G.F. Gordini srl", "tipo": "Prospect", "hall": "C5.449", "cap": "48012", "città": "Bagnacavallo (RA)", "paese": "Italy"}, {"nome": "GEAX SRL", "tipo": "Customer", "hall": "FN.720/1", "cap": "62010", "città": "Montefano", "paese": "Italy"}, {"nome": "GSR SpA", "tipo": "Prospect", "hall": "FS.1003/9", "cap": "47924", "città": "Rimini", "paese": "Italy"}, {"nome": "Gherardi srl", "tipo": "Prospect", "hall": "B3.310", "cap": "24010", "città": "AMBRIOLA DI COSTA SERINA", "paese": "Italy"}, {"nome": "Gruppo Minitop srl", "tipo": "Ex-customer", "hall": "A5.303", "cap": "10060", "città": "Bricherasio (TO)", "paese": "Italy"}, {"nome": "Hammer srl", "tipo": "Ex-customer", "hall": "FM.711/4", "cap": "70056", "città": "Molfetta BA", "paese": "Italy"}, {"nome": "Hinowa S.p.A.", "tipo": "Ex-customer", "hall": "FS.904/9", "cap": "37054", "città": "Nogara (VR)", "paese": "Italy"}, {"nome": "Hydra S.r.l.", "tipo": "Prospect", "hall": "FN.522/1", "cap": "40062", "città": "Molinella (BO)", "paese": "Italy"}, {"nome": "IDROFOGLIA s.r.l.", "tipo": "Prospect", "hall": "A6.343", "cap": "61026", "città": "Lunano (PU)", "paese": "Italy"}, {"nome": "ITALMEK S.r.l.", "tipo": "Prospect", "hall": "C5.514", "cap": "25080", "città": "Nuvolento", "paese": "Italy"}, {"nome": "Indeco Ind. Spa", "tipo": "Prospect", "hall": "FM.709/8", "cap": "70132", "città": "Bari (BA)", "paese": "Italy"}, {"nome": "Italmek srl", "tipo": "Prospect", "hall": "C5.514", "cap": "25080", "città": "Nuvolento", "paese": "Italy"}, {"nome": "Jekko srl", "tipo": "Prospect", "hall": "FS.903/6", "cap": "31014", "città": "Colle Umberto", "paese": "Italy"}, {"nome": "KIMERA S.r.l.", "tipo": "Customer", "hall": "FS.905A/7", "cap": "41019", "città": "Soliera", "paese": "Italy"}, {"nome": "LAMETER s.r.l.", "tipo": "Prospect", "hall": "B5.338", "cap": "16162", "città": "Genova", "paese": "Italy"}, {"nome": "M3 Metalmeccanica Moderna s.r.l.", "tipo": "Ex-customer", "hall": "B5.150", "cap": "43058", "città": "Sorbolo Mezzani", "paese": "Italy"}, {"nome": "MASSUCCO T. S.R.L.", "tipo": "Customer", "hall": "C45.C45.18", "cap": "12100", "città": "Cuneo", "paese": "Italy"}, {"nome": "MASTERMECH SRL", "tipo": "Customer", "hall": "B5.502", "cap": "70056", "città": "Molfetta", "paese": "Italy"}, {"nome": "MAUCOTOOLS SRL", "tipo": "Prospect", "hall": "EWE.13", "cap": "88044", "città": "Marcellinara", "paese": "Italy"}, {"nome": "MB SpA", "tipo": "Customer", "hall": "FN.1017/10", "cap": "36030", "città": "Fara Vicentino (VI)", "paese": "Italy"}, {"nome": "MDB Srl", "tipo": "Prospect", "hall": "FS.1211/2", "cap": "66022", "città": "FOSSACESIA (CH)", "paese": "Italy"}, {"nome": "Magni Telescopic Handlers srl", "tipo": "Prospect", "hall": "FS.1108/3", "cap": "41013", "città": "Castelfranco Emilia", "paese": "Italy"}, {"nome": "Mait Spa", "tipo": "Prospect", "hall": "A6.145", "cap": "60027", "città": "Osimo (AN)", "paese": "Italy"}, {"nome": "Mantovanibenne srl", "tipo": "Prospect", "hall": "FN.917/2", "cap": "41037", "città": "Mirandola (MO)", "paese": "Italy"}, {"nome": "Marini S.p.A.", "tipo": "Prospect", "hall": "FS.1009", "cap": "48011", "città": "Alfonsine-Ravenna", "paese": "Italy"}, {"nome": "Massucco T. srl", "tipo": "Customer", "hall": "C45.C45.18", "cap": "12100", "città": "Cuneo", "paese": "Italy"}, {"nome": "Messersi&#x27; Spa", "tipo": "Prospect", "hall": "FN.1017/2", "cap": "60010", "città": "Casine di Ostra", "paese": "Italy"}, {"nome": "Multitel Pagliero S.p.a.", "tipo": "Prospect", "hall": "FS.1102/10", "cap": "20861", "città": "Brugherio (MB)", "paese": "Italy"}, {"nome": "NMG ITALIA SRL", "tipo": "Customer", "hall": "FS.1106/8", "cap": "37045", "città": "Legnago", "paese": "Italy"}, {"nome": "OF.ME.R. s.r.l", "tipo": "Prospect", "hall": "A1.422", "cap": "20056", "città": "Trezzo sullAdda MI", "paese": "Italy"}, {"nome": "OFM Top Line srl", "tipo": "Prospect", "hall": "A5.312", "cap": "41057", "città": "Spilamberto (MO)", "paese": "Italy"}, {"nome": "ORMET S.R.L.", "tipo": "Customer", "hall": "FS.1103/6", "cap": "31014", "città": "Colle Umberto", "paese": "Italy"}, {"nome": "OSA demolition equipment s.r.l", "tipo": "Ex-customer", "hall": "C5.239", "cap": "70056", "città": "Molfetta", "paese": "Italy"}, {"nome": "Omd Depalo srl", "tipo": "Prospect", "hall": "B5.326", "cap": "70032", "città": "Bitonto (BA)", "paese": "Italy"}, {"nome": "Ormig S.p.A.", "tipo": "Prospect", "hall": "FS.1006/7", "cap": "15076", "città": "Ovada", "paese": "Italy"}, {"nome": "Orsi Group S.r.l.", "tipo": "Prospect", "hall": "B5.241", "cap": "40050", "città": "Castello d&#x27;Argile", "paese": "Italy"}, {"nome": "PLATFORM BASKET s.r.l.", "tipo": "Prospect", "hall": "FS.1103/2", "cap": "42028", "città": "Poviglio", "paese": "Italy"}, {"nome": "PROMOVE S.R.L.", "tipo": "Prospect", "hall": "FN.815/9", "cap": "70056", "città": "Molfetta (BA)", "paese": "Italy"}, {"nome": "Palazzani Industrie S.p.A.", "tipo": "Prospect", "hall": "FS.907A/1", "cap": "25050", "città": "Paderno Franciacorta", "paese": "Italy"}, {"nome": "RMC S.r.l", "tipo": "Customer", "hall": "A5.110", "cap": "29100", "città": "Piacenza 01", "paese": "Italy"}, {"nome": "Rima Spa", "tipo": "Prospect", "hall": "A4.220", "cap": "25018", "città": "Montichiari", "paese": "Italy"}, {"nome": "SAI SPA", "tipo": "Prospect", "hall": "A3.538", "cap": "41122", "città": "Modena", "paese": "Italy"}, {"nome": "SAMEP Tools sas", "tipo": "Customer", "hall": "C5.249", "cap": "10098", "città": "Rivoli (TORINO)", "paese": "Italy"}, {"nome": "SERMAC S.R.L", "tipo": "Prospect", "hall": "FS.1004/2", "cap": "20811", "città": "Cesano Maderno", "paese": "Italy"}, {"nome": "SIR MECCANICA SpA", "tipo": "Prospect", "hall": "B5.424", "cap": "88100", "città": "Catanzaro", "paese": "Italy"}, {"nome": "SOCOMEC S.p.a.", "tipo": "Prospect", "hall": "B5.146", "cap": "43014", "città": "Medesano (PR)", "paese": "Italy"}, {"nome": "STARPOWER SRL", "tipo": "Prospect", "hall": "A4.132", "cap": "42016", "città": "Guastalla (RE)", "paese": "Italy"}, {"nome": "Sami srl", "tipo": "Prospect", "hall": "C1.203", "cap": "52011", "città": "Bibbiena (AR)", "paese": "Italy"}, {"nome": "Simex S.r.l.", "tipo": "Customer", "hall": "C5.325", "cap": "40017", "città": "San Giovanni in Persiceto (BO)", "paese": "Italy"}, {"nome": "Simex s.r.l", "tipo": "Ex-customer", "hall": "C5.325", "cap": "40017", "città": "San Giovanni in Persiceto (BO)", "paese": "Italy"}, {"nome": "Simex srl", "tipo": "Ex-customer", "hall": "C5.325", "cap": "40017", "città": "San Giovanni in Persiceto (BO)", "paese": "Italy"}, {"nome": "Socage s.r.l", "tipo": "Prospect", "hall": "FS.1204/10", "cap": "41012", "città": "CARPI", "paese": "Italy"}, {"nome": "Soilmec Spa", "tipo": "Prospect", "hall": "FN.319/B", "cap": "47522", "città": "Cesena FC", "paese": "Italy"}, {"nome": "Soltec srl", "tipo": "Prospect", "hall": "FS.1001/10", "cap": "63074", "città": "San Benedetto del Tronto", "paese": "Italy"}, {"nome": "TECNO-GRU Srl", "tipo": "Customer", "hall": "FS.1001/3", "cap": "20042", "città": "Pessano con Bornago", "paese": "Italy"}, {"nome": "TESMEC S.p.A.", "tipo": "Ex-customer", "hall": "FN.919/3", "cap": "24050", "città": "Grassobbio (BG)", "paese": "Italy"}, {"nome": "Tecna Group S.r.l", "tipo": "Prospect", "hall": "C5.514", "cap": "70021", "città": "Acquaviva delle Fonti ( Bari)", "paese": "Italy"}, {"nome": "Tifermec Oleodinamica srl", "tipo": "Prospect", "hall": "B5.405", "cap": "6012", "città": "Cerbara di Citta di Castello", "paese": "Italy"}, {"nome": "Tonti Trading Srl", "tipo": "Ex-customer", "hall": "FN.620/7", "cap": "60027", "città": "Osimo", "paese": "Italy"}, {"nome": "Trevi Benne S.p.A.", "tipo": "Prospect", "hall": "C5.503", "cap": "36025", "città": "Noventa Vicentina (VI)", "paese": "Italy"}, {"nome": "Trime srl", "tipo": "Ex-customer", "hall": "A5.411", "cap": "20081", "città": "Cassinetta di Lugagnano", "paese": "Italy"}, {"nome": "Usco Spa", "tipo": "Prospect", "hall": "A5.249", "cap": "41122", "città": "Modena", "paese": "Italy"}, {"nome": "V.T.N. EUROPE S.p.A.", "tipo": "Ex-customer", "hall": "B5.413", "cap": "36026", "città": "CAGNANO DI POIANA MAGGIORE", "paese": "Italy"}, {"nome": "Verco srl", "tipo": "Prospect", "hall": "B5.227", "cap": "25079", "città": "Vobarno", "paese": "Italy"}, {"nome": "Veronafiere S.p.A.", "tipo": "Prospect", "hall": "EOE.17", "cap": "37135", "città": "Verona", "paese": "Italy"}, {"nome": "Visa S.p.a.", "tipo": "Prospect", "hall": "A6.502", "cap": "31043", "città": "FONTANELLE", "paese": "Italy"}];
</script>

<script>
  const clienti = [{"nome": "Agri World srl", "tipo": "Prospect", "hall": "B2.332", "cap": "70022", "città": "Altamura", "paese": "Italy"}, {"nome": "BERTI MACCHINE AGRICOLE S.p.A", "tipo": "Ex-customer", "hall": "B5.538", "cap": "37042", "città": "Caldiero(VR)", "paese": "Italy"}, {"nome": "Batmatic Srl", "tipo": "Prospect", "hall": "A1.105", "cap": "43010", "città": "Fontevivo", "paese": "Italy"}, {"nome": "Beretta Alfredo s.r.l.", "tipo": "Prospect", "hall": "FN.618/1", "cap": "20842", "città": "Besana Brianza (MI)", "paese": "Italy"}, {"nome": "Betonmec srl", "tipo": "Prospect", "hall": "B1.148", "cap": "6055", "città": "MARCSIANO (PG)", "paese": "Italy"}, {"nome": "Boscaro srl", "tipo": "Prospect", "hall": "FM.708/7", "cap": "36020", "città": "Campiglia dei Berici", "paese": "Italy"}, {"nome": "C&amp;F srl", "tipo": "Prospect", "hall": "C5.500", "cap": "73100", "città": "Lecce", "paese": "Italy"}, {"nome": "C.A.M.E. srl", "tipo": "Prospect", "hall": "C5.427", "cap": "36025", "città": "Noventa Vicentina", "paese": "Italy"}, {"nome": "C4 Meccanica srl", "tipo": "Prospect", "hall": "C4.709", "cap": "6019", "città": "Umbertide", "paese": "Italy"}, {"nome": "CAME s.r.l.", "tipo": "Prospect", "hall": "C5.427", "cap": "36025", "città": "Noventa Vicentina", "paese": "Italy"}, {"nome": "CAMS srl", "tipo": "Prospect", "hall": "FS.1213/1", "cap": "40024", "città": "Castel S. Pietro Terme", "paese": "Italy"}, {"nome": "CARON A&amp;D SRL", "tipo": "Prospect", "hall": "A3.500", "cap": "36060", "città": "PIANEZZE", "paese": "Italy"}, {"nome": "CEP Europe S.r.l.", "tipo": "Prospect", "hall": "A5.235", "cap": "41021", "città": "Fanano", "paese": "Italy"}, {"nome": "CIFA S.p.A.", "tipo": "Prospect", "hall": "FS.1105/4", "cap": "20030", "città": "SENAGO", "paese": "Italy"}, {"nome": "CM Srl", "tipo": "Customer", "hall": "FS.1213/4", "cap": "48017", "città": "Conselice", "paese": "Italy"}, {"nome": "CMB s.r.l", "tipo": "Prospect", "hall": "B5.328", "cap": "36020", "città": "ASIGLIANO VENETO", "paese": "Italy"}, {"nome": "CMC srl", "tipo": "Prospect", "hall": "FS.1203/5", "cap": "70124", "città": "Bari", "paese": "Italy"}, {"nome": "CNH Industrial", "tipo": "Customer", "hall": "FM.714/9", "cap": "10156", "città": "Torino", "paese": "Italy"}, {"nome": "CORIMAG srl", "tipo": "Prospect", "hall": "B5.324", "cap": "10080", "città": "Bosconero (TO)", "paese": "Italy"}, {"nome": "CTE spa", "tipo": "Prospect", "hall": "FS.1103/10", "cap": "38068", "città": "Rovereto (TN)", "paese": "Italy"}, {"nome": "Cappellotto Spa", "tipo": "Prospect", "hall": "B4.403", "cap": "33074", "città": "Fontanafredda (PN)", "paese": "Italy"}, {"nome": "Casagrande Spa", "tipo": "Prospect", "hall": "FN.520/9", "cap": "33074", "città": "Fontanafredda", "paese": "Italy"}, {"nome": "Cattini Oleopneumatica Srl", "tipo": "Prospect", "hall": "C4.419", "cap": "42043", "città": "Gattatico", "paese": "Italy"}, {"nome": "Ciancaleoni s.r.l.", "tipo": "Customer", "hall": "FN.620/5", "cap": "6038", "città": "Spello", "paese": "Italy"}, {"nome": "Cormach Srl", "tipo": "Prospect", "hall": "FN.722/9", "cap": "25018", "città": "Montichiari (BS)", "paese": "Italy"}, {"nome": "Cosben srl", "tipo": "Prospect", "hall": "B5.140", "cap": "41030", "città": "Solara", "paese": "Italy"}, {"nome": "DIECI S.r.l.", "tipo": "Prospect", "hall": "FS.1108/1", "cap": "42027", "città": "Montecchio Emilia (RE)", "paese": "Italy"}, {"nome": "DULEVO International Spa", "tipo": "Prospect", "hall": "FS.1009", "cap": "43012", "città": "Fontanellato (PR)", "paese": "Italy"}, {"nome": "Definitive CLM s.r.l.", "tipo": "Prospect", "hall": "C5.236", "cap": "41030", "città": "San Prospero sulla Secchia", "paese": "Italy"}, {"nome": "Dondi S.p.A.", "tipo": "Prospect", "hall": "B5.430", "cap": "6083", "città": "Bastia Umbra", "paese": "Italy"}, {"nome": "Elsa srl", "tipo": "Customer", "hall": "B5.415", "cap": "88050", "città": "Sellia Marina (CZ)", "paese": "Italy"}, {"nome": "Emiliana Serbatoi srl", "tipo": "Ex-customer", "hall": "B5.548", "cap": "41011", "città": "Campogalliano (MO)", "paese": "Italy"}, {"nome": "Euromach Srl", "tipo": "Prospect", "hall": "FN.722/9", "cap": "25018", "città": "MONTICHIARI", "paese": "Italy"}, {"nome": "Euromecc srl", "tipo": "Prospect", "hall": "C1.328", "cap": "95045", "città": "Misterbianco", "paese": "Italy"}, {"nome": "Europarts srl", "tipo": "Prospect", "hall": "A6.450", "cap": "35010", "città": "VIGONZA", "paese": "Italy"}, {"nome": "FERRARI INTERNATIONAL S.P.A.", "tipo": "Prospect", "hall": "FN.920/10", "cap": "42122", "città": "Reggio Emilia", "paese": "Italy"}, {"nome": "FIORI GROUP S.p.A.", "tipo": "Prospect", "hall": "C6.113", "cap": "41034", "città": "Finale Emilia (MO)", "paese": "Italy"}, {"nome": "Femac srl", "tipo": "Prospect", "hall": "B5.203", "cap": "6018", "città": "CITTA&#x27; DI CASTELLO", "paese": "Italy"}, {"nome": "G.A. Ricambi S.p.A.", "tipo": "Prospect", "hall": "A5.336", "cap": "41018", "città": "San Cesario Sul Panaro (Mo)", "paese": "Italy"}, {"nome": "G.F. Gordini srl", "tipo": "Prospect", "hall": "C5.449", "cap": "48012", "città": "Bagnacavallo (RA)", "paese": "Italy"}, {"nome": "GEAX SRL", "tipo": "Customer", "hall": "FN.720/1", "cap": "62010", "città": "Montefano", "paese": "Italy"}, {"nome": "GSR SpA", "tipo": "Prospect", "hall": "FS.1003/9", "cap": "47924", "città": "Rimini", "paese": "Italy"}, {"nome": "Gherardi srl", "tipo": "Prospect", "hall": "B3.310", "cap": "24010", "città": "AMBRIOLA DI COSTA SERINA", "paese": "Italy"}, {"nome": "Gruppo Minitop srl", "tipo": "Ex-customer", "hall": "A5.303", "cap": "10060", "città": "Bricherasio (TO)", "paese": "Italy"}, {"nome": "Hammer srl", "tipo": "Ex-customer", "hall": "FM.711/4", "cap": "70056", "città": "Molfetta BA", "paese": "Italy"}, {"nome": "Hinowa S.p.A.", "tipo": "Ex-customer", "hall": "FS.904/9", "cap": "37054", "città": "Nogara (VR)", "paese": "Italy"}, {"nome": "Hydra S.r.l.", "tipo": "Prospect", "hall": "FN.522/1", "cap": "40062", "città": "Molinella (BO)", "paese": "Italy"}, {"nome": "IDROFOGLIA s.r.l.", "tipo": "Prospect", "hall": "A6.343", "cap": "61026", "città": "Lunano (PU)", "paese": "Italy"}, {"nome": "ITALMEK S.r.l.", "tipo": "Prospect", "hall": "C5.514", "cap": "25080", "città": "Nuvolento", "paese": "Italy"}, {"nome": "Indeco Ind. Spa", "tipo": "Prospect", "hall": "FM.709/8", "cap": "70132", "città": "Bari (BA)", "paese": "Italy"}, {"nome": "Italmek srl", "tipo": "Prospect", "hall": "C5.514", "cap": "25080", "città": "Nuvolento", "paese": "Italy"}, {"nome": "Jekko srl", "tipo": "Prospect", "hall": "FS.903/6", "cap": "31014", "città": "Colle Umberto", "paese": "Italy"}, {"nome": "KIMERA S.r.l.", "tipo": "Customer", "hall": "FS.905A/7", "cap": "41019", "città": "Soliera", "paese": "Italy"}, {"nome": "LAMETER s.r.l.", "tipo": "Prospect", "hall": "B5.338", "cap": "16162", "città": "Genova", "paese": "Italy"}, {"nome": "M3 Metalmeccanica Moderna s.r.l.", "tipo": "Ex-customer", "hall": "B5.150", "cap": "43058", "città": "Sorbolo Mezzani", "paese": "Italy"}, {"nome": "MASSUCCO T. S.R.L.", "tipo": "Customer", "hall": "C45.C45.18", "cap": "12100", "città": "Cuneo", "paese": "Italy"}, {"nome": "MASTERMECH SRL", "tipo": "Customer", "hall": "B5.502", "cap": "70056", "città": "Molfetta", "paese": "Italy"}, {"nome": "MAUCOTOOLS SRL", "tipo": "Prospect", "hall": "EWE.13", "cap": "88044", "città": "Marcellinara", "paese": "Italy"}, {"nome": "MB SpA", "tipo": "Customer", "hall": "FN.1017/10", "cap": "36030", "città": "Fara Vicentino (VI)", "paese": "Italy"}, {"nome": "MDB Srl", "tipo": "Prospect", "hall": "FS.1211/2", "cap": "66022", "città": "FOSSACESIA (CH)", "paese": "Italy"}, {"nome": "Magni Telescopic Handlers srl", "tipo": "Prospect", "hall": "FS.1108/3", "cap": "41013", "città": "Castelfranco Emilia", "paese": "Italy"}, {"nome": "Mait Spa", "tipo": "Prospect", "hall": "A6.145", "cap": "60027", "città": "Osimo (AN)", "paese": "Italy"}, {"nome": "Mantovanibenne srl", "tipo": "Prospect", "hall": "FN.917/2", "cap": "41037", "città": "Mirandola (MO)", "paese": "Italy"}, {"nome": "Marini S.p.A.", "tipo": "Prospect", "hall": "FS.1009", "cap": "48011", "città": "Alfonsine-Ravenna", "paese": "Italy"}, {"nome": "Massucco T. srl", "tipo": "Customer", "hall": "C45.C45.18", "cap": "12100", "città": "Cuneo", "paese": "Italy"}, {"nome": "Messersi&#x27; Spa", "tipo": "Prospect", "hall": "FN.1017/2", "cap": "60010", "città": "Casine di Ostra", "paese": "Italy"}, {"nome": "Multitel Pagliero S.p.a.", "tipo": "Prospect", "hall": "FS.1102/10", "cap": "20861", "città": "Brugherio (MB)", "paese": "Italy"}, {"nome": "NMG ITALIA SRL", "tipo": "Customer", "hall": "FS.1106/8", "cap": "37045", "città": "Legnago", "paese": "Italy"}, {"nome": "OF.ME.R. s.r.l", "tipo": "Prospect", "hall": "A1.422", "cap": "20056", "città": "Trezzo sullAdda MI", "paese": "Italy"}, {"nome": "OFM Top Line srl", "tipo": "Prospect", "hall": "A5.312", "cap": "41057", "città": "Spilamberto (MO)", "paese": "Italy"}, {"nome": "ORMET S.R.L.", "tipo": "Customer", "hall": "FS.1103/6", "cap": "31014", "città": "Colle Umberto", "paese": "Italy"}, {"nome": "OSA demolition equipment s.r.l", "tipo": "Ex-customer", "hall": "C5.239", "cap": "70056", "città": "Molfetta", "paese": "Italy"}, {"nome": "Omd Depalo srl", "tipo": "Prospect", "hall": "B5.326", "cap": "70032", "città": "Bitonto (BA)", "paese": "Italy"}, {"nome": "Ormig S.p.A.", "tipo": "Prospect", "hall": "FS.1006/7", "cap": "15076", "città": "Ovada", "paese": "Italy"}, {"nome": "Orsi Group S.r.l.", "tipo": "Prospect", "hall": "B5.241", "cap": "40050", "città": "Castello d&#x27;Argile", "paese": "Italy"}, {"nome": "PLATFORM BASKET s.r.l.", "tipo": "Prospect", "hall": "FS.1103/2", "cap": "42028", "città": "Poviglio", "paese": "Italy"}, {"nome": "PROMOVE S.R.L.", "tipo": "Prospect", "hall": "FN.815/9", "cap": "70056", "città": "Molfetta (BA)", "paese": "Italy"}, {"nome": "Palazzani Industrie S.p.A.", "tipo": "Prospect", "hall": "FS.907A/1", "cap": "25050", "città": "Paderno Franciacorta", "paese": "Italy"}, {"nome": "RMC S.r.l", "tipo": "Customer", "hall": "A5.110", "cap": "29100", "città": "Piacenza 01", "paese": "Italy"}, {"nome": "Rima Spa", "tipo": "Prospect", "hall": "A4.220", "cap": "25018", "città": "Montichiari", "paese": "Italy"}, {"nome": "SAI SPA", "tipo": "Prospect", "hall": "A3.538", "cap": "41122", "città": "Modena", "paese": "Italy"}, {"nome": "SAMEP Tools sas", "tipo": "Customer", "hall": "C5.249", "cap": "10098", "città": "Rivoli (TORINO)", "paese": "Italy"}, {"nome": "SERMAC S.R.L", "tipo": "Prospect", "hall": "FS.1004/2", "cap": "20811", "città": "Cesano Maderno", "paese": "Italy"}, {"nome": "SIR MECCANICA SpA", "tipo": "Prospect", "hall": "B5.424", "cap": "88100", "città": "Catanzaro", "paese": "Italy"}, {"nome": "SOCOMEC S.p.a.", "tipo": "Prospect", "hall": "B5.146", "cap": "43014", "città": "Medesano (PR)", "paese": "Italy"}, {"nome": "STARPOWER SRL", "tipo": "Prospect", "hall": "A4.132", "cap": "42016", "città": "Guastalla (RE)", "paese": "Italy"}, {"nome": "Sami srl", "tipo": "Prospect", "hall": "C1.203", "cap": "52011", "città": "Bibbiena (AR)", "paese": "Italy"}, {"nome": "Simex S.r.l.", "tipo": "Customer", "hall": "C5.325", "cap": "40017", "città": "San Giovanni in Persiceto (BO)", "paese": "Italy"}, {"nome": "Simex s.r.l", "tipo": "Ex-customer", "hall": "C5.325", "cap": "40017", "città": "San Giovanni in Persiceto (BO)", "paese": "Italy"}, {"nome": "Simex srl", "tipo": "Ex-customer", "hall": "C5.325", "cap": "40017", "città": "San Giovanni in Persiceto (BO)", "paese": "Italy"}, {"nome": "Socage s.r.l", "tipo": "Prospect", "hall": "FS.1204/10", "cap": "41012", "città": "CARPI", "paese": "Italy"}, {"nome": "Soilmec Spa", "tipo": "Prospect", "hall": "FN.319/B", "cap": "47522", "città": "Cesena FC", "paese": "Italy"}, {"nome": "Soltec srl", "tipo": "Prospect", "hall": "FS.1001/10", "cap": "63074", "città": "San Benedetto del Tronto", "paese": "Italy"}, {"nome": "TECNO-GRU Srl", "tipo": "Customer", "hall": "FS.1001/3", "cap": "20042", "città": "Pessano con Bornago", "paese": "Italy"}, {"nome": "TESMEC S.p.A.", "tipo": "Ex-customer", "hall": "FN.919/3", "cap": "24050", "città": "Grassobbio (BG)", "paese": "Italy"}, {"nome": "Tecna Group S.r.l", "tipo": "Prospect", "hall": "C5.514", "cap": "70021", "città": "Acquaviva delle Fonti ( Bari)", "paese": "Italy"}, {"nome": "Tifermec Oleodinamica srl", "tipo": "Prospect", "hall": "B5.405", "cap": "6012", "città": "Cerbara di Citta di Castello", "paese": "Italy"}, {"nome": "Tonti Trading Srl", "tipo": "Ex-customer", "hall": "FN.620/7", "cap": "60027", "città": "Osimo", "paese": "Italy"}, {"nome": "Trevi Benne S.p.A.", "tipo": "Prospect", "hall": "C5.503", "cap": "36025", "città": "Noventa Vicentina (VI)", "paese": "Italy"}, {"nome": "Trime srl", "tipo": "Ex-customer", "hall": "A5.411", "cap": "20081", "città": "Cassinetta di Lugagnano", "paese": "Italy"}, {"nome": "Usco Spa", "tipo": "Prospect", "hall": "A5.249", "cap": "41122", "città": "Modena", "paese": "Italy"}, {"nome": "V.T.N. EUROPE S.p.A.", "tipo": "Ex-customer", "hall": "B5.413", "cap": "36026", "città": "CAGNANO DI POIANA MAGGIORE", "paese": "Italy"}, {"nome": "Verco srl", "tipo": "Prospect", "hall": "B5.227", "cap": "25079", "città": "Vobarno", "paese": "Italy"}, {"nome": "Veronafiere S.p.A.", "tipo": "Prospect", "hall": "EOE.17", "cap": "37135", "città": "Verona", "paese": "Italy"}, {"nome": "Visa S.p.a.", "tipo": "Prospect", "hall": "A6.502", "cap": "31043", "città": "FONTANELLE", "paese": "Italy"}];

  let clienteAttivo = null;
  const lista = document.getElementById("listaClienti");
  const modal = document.getElementById("schedaCliente");

  function renderClienti(filtrati = clienti) {
    lista.innerHTML = "";
    filtrati.forEach(c => {
      const div = document.createElement("div");
      div.className = "cliente";
      div.dataset.nome = c.nome;
      div.innerHTML = `<h3>${c.nome}</h3><small>${c.città}</small>`;
      if (localStorage.getItem("visitato_" + c.nome) === "true") {
        const icon = document.createElement("span");
        icon.className = "visitato-icon";
        icon.innerText = "✓";
        div.appendChild(icon);
      }
      div.onclick = () => apriScheda(c);
      lista.appendChild(div);
    });
  }

  function filterClienti() {
    const q = document.getElementById("searchInput").value.toLowerCase();
    const filtrati = clienti.filter(c =>
      c.nome.toLowerCase().includes(q) ||
      c.città.toLowerCase().includes(q) ||
      c.hall.toLowerCase().includes(q)
    );
    renderClienti(filtrati);
  }

  function apriScheda(c) {
    clienteAttivo = c;
    document.getElementById("clienteNome").innerText = c.nome;
    document.getElementById("clienteTipo").innerText = c.tipo;
    document.getElementById("clienteHall").innerText = c.hall;
    document.getElementById("clienteCAP").innerText = c.cap;
    document.getElementById("clienteCitta").innerText = c.città;
    document.getElementById("clientePaese").innerText = c.paese;
    document.getElementById("note").value = localStorage.getItem("note_" + c.nome) || "";
    document.getElementById("visitatoCheck").checked = localStorage.getItem("visitato_" + c.nome) === "true";
    mostraImmagine(localStorage.getItem("foto_" + c.nome));
    modal.style.display = "flex";
  }

  function chiudiScheda() {
    modal.style.display = "none";
  }

  function salvaNote() {
    const nota = document.getElementById("note").value;
    const visitato = document.getElementById("visitatoCheck").checked;
    if (clienteAttivo) {
      localStorage.setItem("note_" + clienteAttivo.nome, nota);
      localStorage.setItem("visitato_" + clienteAttivo.nome, visitato);
      
  async function salvaNote() {
    const nota = document.getElementById("note").value;
    const visitato = document.getElementById("visitatoCheck").checked;
    const fileInput = document.getElementById("fotoCliente");
    let foto_url = null;

    if (fileInput && fileInput.files[0]) {
      const file = fileInput.files[0];
      const filePath = clienteAttivo.nome.replaceAll(" ", "_") + "/" + file.name;
      const { data, error } = await supabase.storage.from("fotoclienti").upload(filePath, file, { upsert: true });
      if (error) {
        alert("Errore nel caricamento della foto");
        return;
      }
      const { data: publicUrl } = supabase.storage.from("fotoclienti").getPublicUrl(filePath);
      foto_url = publicUrl.publicUrl;
    }

    const { error } = await supabase
      .from("clienti")
      .upsert([{ nome: clienteAttivo.nome, note: nota, visitato: visitato, foto_url: foto_url }], { onConflict: 'nome' });

    if (error) {
      alert("Errore nel salvataggio su Supabase");
      return;
    }

    alert("Salvato correttamente nel cloud!");
    chiudiScheda();
    renderClienti();
  }

  async function apriScheda(c) {
    clienteAttivo = c;
    document.getElementById("clienteNome").innerText = c.nome;
    document.getElementById("clienteTipo").innerText = c.tipo;
    document.getElementById("clienteHall").innerText = c.hall;
    document.getElementById("clienteCAP").innerText = c.cap;
    document.getElementById("clienteCitta").innerText = c.città;
    document.getElementById("clientePaese").innerText = c.paese;
    document.getElementById("note").value = "";
    document.getElementById("visitatoCheck").checked = false;
    document.getElementById("previewFoto").innerHTML = "";

    const {{ data, error }} = await supabase
      .from("clienti")
      .select("note, visitato, foto_url")
      .eq("nome", c.nome)
      .single();

    if (data) {
      document.getElementById("note").value = data.note || "";
      document.getElementById("visitatoCheck").checked = data.visitato || false;
      if (data.foto_url) mostraImmagine(data.foto_url);
    }

    modal.style.display = "flex";
  }

  async function rimuoviImmagine() {
    if (!clienteAttivo) return;
    const { error } = await supabase
      .from("clienti")
      .update({ foto_url: null })
      .eq("nome", clienteAttivo.nome);
    if (!error) mostraImmagine(null);
  }

  renderClienti();
      chiudiScheda();
    }
  }

  function salvaImmagine() {
    const fileInput = document.getElementById("fotoCliente");
    const file = fileInput.files[0];
    if (file && clienteAttivo) {
      const reader = new FileReader();
      reader.onload = function(e) {
        localStorage.setItem("foto_" + clienteAttivo.nome, e.target.result);
        mostraImmagine(e.target.result);
      };
      reader.readAsDataURL(file);
    }
  }

  function mostraImmagine(base64) {
    const preview = document.getElementById("previewFoto");
    if (base64) {
      preview.innerHTML = `<img src="${base64}" style="max-width:100%; border:1px solid #ccc; border-radius:5px;">`;
    } else {
      preview.innerHTML = "";
    }
  }

  function rimuoviImmagine() {
    if (clienteAttivo) {
      localStorage.removeItem("foto_" + clienteAttivo.nome);
      mostraImmagine(null);
    }
  }

  
  async function salvaNote() {
    const nota = document.getElementById("note").value;
    const visitato = document.getElementById("visitatoCheck").checked;
    const fileInput = document.getElementById("fotoCliente");
    let foto_url = null;

    if (fileInput && fileInput.files[0]) {
      const file = fileInput.files[0];
      const filePath = clienteAttivo.nome.replaceAll(" ", "_") + "/" + file.name;
      const { data, error } = await supabase.storage.from("fotoclienti").upload(filePath, file, { upsert: true });
      if (error) {
        alert("Errore nel caricamento della foto");
        return;
      }
      const { data: publicUrl } = supabase.storage.from("fotoclienti").getPublicUrl(filePath);
      foto_url = publicUrl.publicUrl;
    }

    const { error } = await supabase
      .from("clienti")
      .upsert([{ nome: clienteAttivo.nome, note: nota, visitato: visitato, foto_url: foto_url }], { onConflict: 'nome' });

    if (error) {
      alert("Errore nel salvataggio su Supabase");
      return;
    }

    alert("Salvato correttamente nel cloud!");
    chiudiScheda();
    renderClienti();
  }

  async function apriScheda(c) {
    clienteAttivo = c;
    document.getElementById("clienteNome").innerText = c.nome;
    document.getElementById("clienteTipo").innerText = c.tipo;
    document.getElementById("clienteHall").innerText = c.hall;
    document.getElementById("clienteCAP").innerText = c.cap;
    document.getElementById("clienteCitta").innerText = c.città;
    document.getElementById("clientePaese").innerText = c.paese;
    document.getElementById("note").value = "";
    document.getElementById("visitatoCheck").checked = false;
    document.getElementById("previewFoto").innerHTML = "";

    const {{ data, error }} = await supabase
      .from("clienti")
      .select("note, visitato, foto_url")
      .eq("nome", c.nome)
      .single();

    if (data) {
      document.getElementById("note").value = data.note || "";
      document.getElementById("visitatoCheck").checked = data.visitato || false;
      if (data.foto_url) mostraImmagine(data.foto_url);
    }

    modal.style.display = "flex";
  }

  async function rimuoviImmagine() {
    if (!clienteAttivo) return;
    const { error } = await supabase
      .from("clienti")
      .update({ foto_url: null })
      .eq("nome", clienteAttivo.nome);
    if (!error) mostraImmagine(null);
  }

  renderClienti();
</script>

</body>
</html>
